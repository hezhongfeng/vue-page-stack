!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VuePageStack={},e.Vue)}(this,(function(e,t){"use strict";const n=e=>null==e,o=e=>n(e)||""===e,r={keyName:"page_key",componentName:"StackRouterView"};let a;const s=e=>{a=Object.assign(Object.assign({},r),((e,...t)=>{const o={};if(!e||!t)return o;for(const r of t)n(e[r])||(o[r]=e[r]);return o})(e,"keyName","componentName"))},u=()=>a;var i;!function(e){e.PUSH="push",e.GO="go",e.REPLACE="replace",e.BACK="back",e.FORWARD="forward"}(i||(i={}));const c={value:i.PUSH},l=e=>{c.value=e},p=()=>c;let d;const v=()=>d;class f{constructor(e){var t;this.value=null!==(t=null==e?void 0:e.value)&&void 0!==t?t:[]}push(e){return this.value.push(e)}pop(){return this.value.pop()}removeAfter(e){const t=this.value.findIndex((t=>t.key===e));if(-1===t)return;const n=t+1;return n>=this.value.length?void 0:this.value.splice(n,this.value.length-t-1)}clear(){const e=this.value;return this.value=[],e}get(e){var t;return null===(t=this.value.find((t=>t.key===e)))||void 0===t?void 0:t.vnode}}const h=(()=>{const e=new f;return()=>e})();function m(e){let t=e.shapeFlag;256&t&&(t-=256),512&t&&(t-=512),e.shapeFlag=t}const g=t.defineComponent({inheritRef:!0,__isKeepAlive:!0,props:{component:{type:Object,default:void 0},route:{type:Object,required:!0}},setup(e){const n=h(),o=p(),{keyName:r}=u(),a=t.getCurrentInstance(),s=a.ctx,c=a.suspense,{renderer:{p:l,m:d,um:v,o:{createElement:f}}}=s,g=f("div");function y(e){if(e)for(;e.length;){const t=e.pop();t&&(m(t.vnode),v(t.vnode,a,c))}}return s.activate=(e,t,n,o,r)=>{const a=e.component;d(e,t,n,0,c),l(a.vnode,e,t,n,a,c,o,r)},s.deactivate=e=>{d(e,g,null,1,c)},()=>{const{component:a,route:s}=e,u=s.query[r],c=n.get(u),l=a;return l?c?(y(n.removeAfter(u)),c.transition&&t.setTransitionHooks(c,c.transition),c.shapeFlag|=512,c):(o.value===i.REPLACE&&y(n.clear()),n.push({key:u,vnode:l}),l.shapeFlag|=256,l):l}}}),y=()=>{const{keyName:e}=u(),{router:t}=v(),n=p();t.beforeEach(((t,r)=>{if(o(t.query[e])){t.query[e]=((e=6)=>Math.random().toString(16).substring(2,e+2))();const a=n.value===i.REPLACE||o(r.query[e]);return{hash:t.hash,path:t.path,name:t.name,params:t.params,query:t.query,meta:t.meta,replace:a}}return!0}))},b={install(e,t){const{router:n}=t;if(!n)throw Error("\n vue-router is necessary. \n\n");s(t),d={app:e,router:n},(()=>{const{app:e,router:t}=v(),n=t.push.bind(t),o=t.go.bind(t),r=t.replace.bind(t),a=t.back.bind(t),s=t.forward.bind(t);e.config.globalProperties.$router||e.use(t),t.push=e=>(l(i.PUSH),n(e)),t.go=e=>{l(i.GO),o(e)},t.replace=e=>(l(i.REPLACE),r(e)),t.back=()=>{l(i.BACK),a()},t.forward=()=>{l(i.FORWARD),s()}})(),(()=>{const{componentName:e}=u(),{app:t}=v();t.component(e,g)})(),y()}};e.VuePageStack=b,e.useAction=p,e.useStack=h,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=vue-page-stack.umd.js.map
