"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("vue");const t=e=>null==e,n=e=>t(e)||""===e,r={keyName:"page_key",componentName:"StackRouterView"};let o;const a=e=>{o=Object.assign(Object.assign({},r),((e,...n)=>{const r={};if(!e||!n)return r;for(const o of n)t(e[o])||(r[o]=e[o]);return r})(e,"keyName","componentName"))},s=()=>o;var u;!function(e){e.PUSH="push",e.GO="go",e.REPLACE="replace",e.BACK="back",e.FORWARD="forward"}(u||(u={}));const c={value:u.PUSH},i=e=>{c.value=e},p=()=>c;let l;const v=()=>l;class h{constructor(e){var t;this.value=null!==(t=null==e?void 0:e.value)&&void 0!==t?t:[]}push(e){return this.value.push(e)}pop(){return this.value.pop()}removeAfter(e){const t=this.value.findIndex((t=>t.key===e));if(-1===t)return;const n=t+1;return n>=this.value.length?void 0:this.value.splice(n,this.value.length-t-1)}clear(){const e=this.value;return this.value=[],e}get(e){var t;return null===(t=this.value.find((t=>t.key===e)))||void 0===t?void 0:t.vnode}}const d=(()=>{const e=new h;return()=>e})();function m(e){let t=e.shapeFlag;256&t&&(t-=256),512&t&&(t-=512),e.shapeFlag=t}const f=e.defineComponent({inheritRef:!0,__isKeepAlive:!0,props:{component:{type:Object,default:void 0},route:{type:Object,required:!0}},setup(t){const n=d(),r=p(),{keyName:o}=s(),a=e.getCurrentInstance(),c=a.ctx,i=a.suspense,{renderer:{p:l,m:v,um:h,o:{createElement:f}}}=c,g=f("div");function y(e){if(e)for(;e.length;){const t=e.pop();t&&(m(t.vnode),h(t.vnode,a,i))}}return c.activate=(e,t,n,r,o)=>{const a=e.component;v(e,t,n,0,i),l(a.vnode,e,t,n,a,i,r,o)},c.deactivate=e=>{v(e,g,null,1,i)},()=>{const{component:a,route:s}=t,c=s.query[o],i=n.get(c),p=a;return p?i?(y(n.removeAfter(c)),i.transition&&e.setTransitionHooks(i,i.transition),i.shapeFlag|=512,i):(r.value===u.REPLACE&&y(n.clear()),n.push({key:c,vnode:p}),p.shapeFlag|=256,p):p}}}),g=()=>{const{keyName:e}=s(),{router:t}=v(),r=p();t.beforeEach(((t,o)=>{if(n(t.query[e])){t.query[e]=((e=6)=>Math.random().toString(16).substring(2,e+2))();const a=r.value===u.REPLACE||n(o.query[e]);return{hash:t.hash,path:t.path,name:t.name,params:t.params,query:t.query,meta:t.meta,replace:a}}return!0}))},y={install(e,t){const{router:n}=t;if(!n)throw Error("\n vue-router is necessary. \n\n");a(t),l={app:e,router:n},(()=>{const{app:e,router:t}=v(),n=t.push.bind(t),r=t.go.bind(t),o=t.replace.bind(t),a=t.back.bind(t),s=t.forward.bind(t);e.config.globalProperties.$router||e.use(t),t.push=e=>(i(u.PUSH),n(e)),t.go=e=>{i(u.GO),r(e)},t.replace=e=>(i(u.REPLACE),o(e)),t.back=()=>{i(u.BACK),a()},t.forward=()=>{i(u.FORWARD),s()}})(),(()=>{const{componentName:e}=s(),{app:t}=v();t.component(e,f)})(),g()}};exports.VuePageStack=y,exports.useAction=p,exports.useStack=d;
//# sourceMappingURL=vue-page-stack.cjs.js.map
